# Socket
socket相关知识点
1. 孤儿连接/孤儿进程: 客户端执行半关闭后（停留在FIN_WAIT_2状态），未等服务器关闭连接就强行退出，此时客户端连接由内核来接管。Linux为了防止孤儿连接长时间停留在内核中，定义了两个内核变量，控制内核能接管的孤儿连接数目和孤儿连接在内核中的生存时间。
2. close系统调用并非总是立即关闭一个连接，而是将fd的引用计数减1。只有当fd的引用计数为0时，才真正关闭连接。多进程程序中，一次fork系统调用默认将使父进程中打开的socket的引用计数加1，因此我们必须在父进程和子进程中都对该socket执行close调用才能将连接关闭。如果无论如何都要立即终止连接（而不是将socket的引用计数减1），可以使用shutdown系统调用。
